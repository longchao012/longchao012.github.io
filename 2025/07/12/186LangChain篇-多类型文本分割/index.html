<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"mzfnai.com","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"style":"flat"},"back2top":{"enable":true,"sidebar":true,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"搜索文章","hits_empty":"我们没有找到任何搜索结果：${query}","hits_stats":"找到${hits}个结果，耗时${time}毫秒"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="详细介绍LangChain中多种文本分割策略和方法，包括递归分割、字符分割、语义分割等，帮助开发者选择最适合的文本处理方案。">
<meta property="og:type" content="article">
<meta property="og:title" content="LangChain篇-多类型文本分割">
<meta property="og:url" content="http://mzfnai.com/2025/07/12/186LangChain%E7%AF%87-%E5%A4%9A%E7%B1%BB%E5%9E%8B%E6%96%87%E6%9C%AC%E5%88%86%E5%89%B2/index.html">
<meta property="og:site_name" content="妙知赋能AI longchao&#39;s Blog">
<meta property="og:description" content="详细介绍LangChain中多种文本分割策略和方法，包括递归分割、字符分割、语义分割等，帮助开发者选择最适合的文本处理方案。">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2025-07-12T02:23:45.000Z">
<meta property="article:modified_time" content="2025-07-12T02:23:45.000Z">
<meta property="article:author" content="longchao">
<meta property="article:tag" content="LangChain">
<meta property="article:tag" content="文档处理">
<meta property="article:tag" content="文本分割">
<meta property="article:tag" content="递归分割">
<meta property="article:tag" content="文本切块">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://mzfnai.com/2025/07/12/186LangChain%E7%AF%87-%E5%A4%9A%E7%B1%BB%E5%9E%8B%E6%96%87%E6%9C%AC%E5%88%86%E5%89%B2/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>LangChain篇-多类型文本分割 | 妙知赋能AI longchao's Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta custom-logo">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">妙知赋能AI longchao's Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">A blog about life</p>
      <a>
        <img class="custom-logo-image" src="/uploads/custom-logo.jpg" alt="妙知赋能AI longchao's Blog">
      </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>首页</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>归档</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="reading-progress-bar"></div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://mzfnai.com/2025/07/12/186LangChain%E7%AF%87-%E5%A4%9A%E7%B1%BB%E5%9E%8B%E6%96%87%E6%9C%AC%E5%88%86%E5%89%B2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="longchao">
      <meta itemprop="description" content="A blog about life, technology, and everything in between.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="妙知赋能AI longchao's Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          LangChain篇-多类型文本分割
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2025-07-12 10:23:45" itemprop="dateCreated datePublished" datetime="2025-07-12T10:23:45+08:00">2025-07-12</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/AI/" itemprop="url" rel="index"><span itemprop="name">AI</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/AI/LangChain/" itemprop="url" rel="index"><span itemprop="name">LangChain</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span id="busuanzi_value_page_pv"></span>
            </span>
            <div class="post-description">详细介绍LangChain中多种文本分割策略和方法，包括递归分割、字符分割、语义分割等，帮助开发者选择最适合的文本处理方案。</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>在处理文本数据时，文本分割是一个重要的步骤，尤其是在处理长文本或将文本数据输入到机器学习模型中时。LangChain 是一个用于构建大型语言模型应用程序的库，它提供了多种工具和策略来处理文本分割。下面是一些在LangChain中实现文本分割的常见方法：</p>
<h2 id="一、如何递归分割文本"><a href="#一、如何递归分割文本" class="headerlink" title="一、如何递归分割文本"></a>一、如何递归分割文本</h2><p>递归分割(recursively)，这个文本分割器是用于通用文本的推荐工具。它接受一个字符列表作为参数。它会按顺序尝试在这些字符上进行分割，直到块足够小。默认的字符列表是 <code>[&quot;\n\n&quot;, &quot;\n&quot;, &quot; &quot;, &quot;&quot;]</code>。这样做的效果是尽可能保持所有段落（然后是句子，再然后是单词）在一起，因为这些通常看起来是语义上相关的文本块。</p>
<ol>
<li><p>文本如何分割：根据字符列表。</p>
</li>
<li><p>块大小如何衡量：根据字符数量。</p>
</li>
</ol>
<p>下面我们展示一个使用示例。</p>
<p>要直接获取字符串内容，请使用 <code>.split_text</code>。</p>
<p>要创建 LangChain <a target="_blank" rel="noopener" href="https://api.python.langchain.com/en/latest/documents/langchain_core.documents.base.Document.html">Document</a> 对象（例如，用于下游任务），请使用 <code>.create_documents</code>。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%pip install -qU langchain-text-splitters</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 示例：recursively_split.py</span></span><br><span class="line"><span class="keyword">from</span> langchain_text_splitters <span class="keyword">import</span> RecursiveCharacterTextSplitter</span><br><span class="line"></span><br><span class="line"><span class="comment"># 加载示例文档</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;../../resource/knowledge.txt&quot;</span>, encoding=<span class="string">&quot;utf-8&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    state_of_the_union = f.read()</span><br><span class="line">text_splitter = RecursiveCharacterTextSplitter(</span><br><span class="line">    <span class="comment"># 设置一个非常小的块大小，只是为了展示。</span></span><br><span class="line">    chunk_size=<span class="number">100</span>,</span><br><span class="line">    chunk_overlap=<span class="number">20</span>,</span><br><span class="line">    length_function=<span class="built_in">len</span>,</span><br><span class="line">    is_separator_regex=<span class="literal">False</span>,</span><br><span class="line">)</span><br><span class="line">texts = text_splitter.create_documents([state_of_the_union])</span><br><span class="line"><span class="built_in">print</span>(texts[<span class="number">0</span>])</span><br><span class="line"><span class="built_in">print</span>(texts[<span class="number">1</span>])</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">page_content=&#x27;I am honored to be with you today at your commencement from one of the finest universities in the&#x27;</span><br><span class="line">page_content=&#x27;universities in the world. I never graduated from college. Truth be told, this is the closest I&#x27;ve&#x27;</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">text_splitter.split_text(knowledge)[:<span class="number">2</span>]</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="string">&#x27;\ufeffI am honored to be with you today at your commencement from one of the finest universities in the&#x27;</span>, <span class="string">&quot;universities in the world. I never graduated from college. Truth be told, this is the closest I&#x27;ve&quot;</span>]</span><br></pre></td></tr></table></figure>

<p>让我们来看看上述 <code>RecursiveCharacterTextSplitter</code> 的参数设置：</p>
<ul>
<li><p><code>chunk_size</code>：块的最大大小，大小由 <code>length_function</code> 决定。</p>
</li>
<li><p><code>chunk_overlap</code>：块之间的目标重叠。重叠的块有助于在上下文分割时减少信息丢失。</p>
</li>
<li><p><code>length_function</code>：确定块大小的函数。</p>
</li>
<li><p><code>is_separator_regex</code>：分隔符列表（默认为 <code>[&quot;\n\n&quot;, &quot;\n&quot;, &quot; &quot;, &quot;&quot;]</code>）是否应被解释为正则表达式。</p>
</li>
</ul>
<h3 id="从没有词边界的语言中分割文本"><a href="#从没有词边界的语言中分割文本" class="headerlink" title="从没有词边界的语言中分割文本"></a>从没有词边界的语言中分割文本</h3><p>一些书写系统没有<a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Category:Writing_systems_without_word_boundaries">词边界</a>，例如中文、日文和泰文。使用默认分隔符列表 <code>[&quot;\n\n&quot;, &quot;\n&quot;, &quot; &quot;, &quot;&quot;]</code> 分割文本可能会导致单词被分割在不同块之间。为了保持单词在一起，您可以覆盖分隔符列表，包括额外的标点符号：</p>
<ul>
<li><p>添加 ASCII 句号 “<code>.</code>“，<a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Halfwidth_and_Fullwidth_Forms_(Unicode_block)">Unicode 全角</a> 句号 “<code>．</code>“（用于中文文本），以及<a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/CJK_Symbols_and_Punctuation">表意句号</a> “<code>。</code>“（用于日文和中文）</p>
</li>
<li><p>添加<a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Zero-width_space">零宽空格</a> 用于泰文、缅甸文、高棉文和日文。</p>
</li>
<li><p>添加 ASCII 逗号 “<code>,</code>“，Unicode 全角逗号 “<code>，</code>“，以及 Unicode 表意逗号 “<code>、</code>“</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 示例：recursively_separator.py</span></span><br><span class="line">text_splitter = RecursiveCharacterTextSplitter(</span><br><span class="line">    separators=[</span><br><span class="line">        <span class="string">&quot;\n\n&quot;</span>,</span><br><span class="line">        <span class="string">&quot;\n&quot;</span>,</span><br><span class="line">        <span class="string">&quot; &quot;</span>,</span><br><span class="line">        <span class="string">&quot;.&quot;</span>,</span><br><span class="line">        <span class="string">&quot;,&quot;</span>,</span><br><span class="line">        <span class="string">&quot;\u200b&quot;</span>,  <span class="comment"># 零宽空格</span></span><br><span class="line">        <span class="string">&quot;\uff0c&quot;</span>,  <span class="comment"># 全角逗号</span></span><br><span class="line">        <span class="string">&quot;\u3001&quot;</span>,  <span class="comment"># 表意逗号</span></span><br><span class="line">        <span class="string">&quot;\uff0e&quot;</span>,  <span class="comment"># 全角句号</span></span><br><span class="line">        <span class="string">&quot;\u3002&quot;</span>,  <span class="comment"># 表意句号&quot;&quot;,</span></span><br><span class="line">    ],</span><br><span class="line">    <span class="comment"># 已有的参数</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>



<h2 id="二、按照语义块分割文本"><a href="#二、按照语义块分割文本" class="headerlink" title="二、按照语义块分割文本"></a>二、按照语义块分割文本</h2><p>下面介绍如何根据语义相似性拆分文本块(semantic chunks)。如果嵌入足够远，文本块将被拆分。</p>
<p>在高层次上，这将文本拆分成句子，然后分组为每组 3 个句子，最后合并在嵌入空间中相似的句子。</p>
<h3 id="1-安装依赖项"><a href="#1-安装依赖项" class="headerlink" title="1. 安装依赖项"></a>1. 安装依赖项</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#pip install --quiet langchain_experimental langchain_openai</span></span><br></pre></td></tr></table></figure>

<h3 id="2-载入示例数据"><a href="#2-载入示例数据" class="headerlink" title="2. 载入示例数据"></a>2. 载入示例数据</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 示例：semantic_split.py</span></span><br><span class="line"><span class="comment"># 这是一个长文档，我们可以将其拆分。</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;../../resource/knowledge.txt&quot;</span>, encoding=<span class="string">&quot;utf-8&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    knowledge = f.read()</span><br></pre></td></tr></table></figure>

<h3 id="3-创建文本拆分器"><a href="#3-创建文本拆分器" class="headerlink" title="3. 创建文本拆分器"></a>3. 创建文本拆分器</h3><p>要实例化一个 <a target="_blank" rel="noopener" href="https://api.python.langchain.com/en/latest/text_splitter/langchain_experimental.text_splitter.SemanticChunker.html">SemanticChunker</a>，我们必须指定一个嵌入模型。下面我们将使用 <a target="_blank" rel="noopener" href="https://api.python.langchain.com/en/latest/embeddings/langchain_community.embeddings.openai.OpenAIEmbeddings.html">OpenAIEmbeddings</a>。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_experimental.text_splitter <span class="keyword">import</span> SemanticChunker</span><br><span class="line"><span class="keyword">from</span> langchain_openai.embeddings <span class="keyword">import</span> OpenAIEmbeddings</span><br><span class="line">text_splitter = SemanticChunker(OpenAIEmbeddings())</span><br></pre></td></tr></table></figure>

<h3 id="4-拆分文本"><a href="#4-拆分文本" class="headerlink" title="4. 拆分文本"></a>4. 拆分文本</h3><p>我们按照通常的方式拆分文本，例如，通过调用 <code>.create_documents</code> 来创建 LangChain <a target="_blank" rel="noopener" href="https://api.python.langchain.com/en/latest/documents/langchain_core.documents.base.Document.html">Document</a> 对象：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docs = text_splitter.create_documents([knowledge])</span><br><span class="line"><span class="built_in">print</span>(docs[<span class="number">0</span>].page_content)</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">I am honored to be with you today at your commencement from one of the finest universities in the world. I never graduated from college. Truth be told, this is the closest I&#x27;ve ever gotten to a college graduation. Today I want to tell you three stories from my life. That&#x27;s it. No big deal.</span><br></pre></td></tr></table></figure>

<h3 id="5-断点"><a href="#5-断点" class="headerlink" title="5. 断点"></a>5. 断点</h3><p>这个拆分器的工作原理是确定何时“断开”句子。这是通过查找任意两个句子之间的嵌入差异来完成的。当该差异超过某个阈值时，它们就会被拆分。</p>
<p>有几种方法可以确定该阈值，这由 <code>breakpoint_threshold_type</code> 关键字参数控制。</p>
<h4 id="百分位数"><a href="#百分位数" class="headerlink" title="百分位数"></a>百分位数</h4><p>拆分的默认方式是基于百分位数。在此方法中，计算所有句子之间的差异，然后任何大于X百分位数的差异都会被拆分。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 示例：semantic_split_percentile.py</span></span><br><span class="line">text_splitter = SemanticChunker(</span><br><span class="line">    OpenAIEmbeddings(), breakpoint_threshold_type=<span class="string">&quot;percentile&quot;</span>, breakpoint_threshold_amount=<span class="number">50</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docs = text_splitter.create_documents([knowledge])</span><br><span class="line"><span class="built_in">print</span>(docs[<span class="number">0</span>].page_content)</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">I am honored to be with you today at your commencement from one of the finest universities in the world. I never graduated from college.</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(docs))</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">71</span><br></pre></td></tr></table></figure>



<h2 id="三、如何按标题拆分-Markdown"><a href="#三、如何按标题拆分-Markdown" class="headerlink" title="三、如何按标题拆分 Markdown"></a>三、如何按标题拆分 Markdown</h2><h3 id="1-动机"><a href="#1-动机" class="headerlink" title="1. 动机"></a>1. 动机</h3><p>许多聊天或问答应用程序在嵌入和向量存储之前需要对输入文档进行分块。</p>
<p>Pinecone 的这些<a target="_blank" rel="noopener" href="https://www.pinecone.io/learn/chunking-strategies/">笔记</a>提供了一些有用的提示：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">当嵌入整个段落或文档时，嵌入过程会考虑文本中句子和短语之间的整体上下文和关系。这可能会导致更全面的向量表示，捕捉到文本的更广泛的含义和主题。</span><br></pre></td></tr></table></figure>

<p>正如上面提到的，分块通常旨在将具有共同上下文的文本保持在一起。考虑到这一点，我们可能希望特别尊重文档本身的结构。例如，Markdown 文件是按标题组织的。在特定标题组中创建分块是一个直观的想法。为了解决这个挑战，我们可以使用 <a target="_blank" rel="noopener" href="https://api.python.langchain.com/en/latest/markdown/langchain_text_splitters.markdown.MarkdownHeaderTextSplitter.html">MarkdownHeaderTextSplitter</a>。它可以根据指定的一组标题来拆分 Markdown 文件。</p>
<p>例如，如果我们想要拆分这个 Markdown：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">md = &#x27;# Foo\n\n ## Bar\n\nHi this is Jim  \nHi this is Joe\n\n ## Baz\n\n Hi this is Molly&#x27;</span><br></pre></td></tr></table></figure>

<p>我们可以指定要拆分的标题：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[(&quot;#&quot;, &quot;Header 1&quot;),(&quot;##&quot;, &quot;Header 2&quot;)]</span><br></pre></td></tr></table></figure>

<p>内容将根据共同的标题进行分组或拆分：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#x27;content&#x27;: &#x27;Hi this is Jim  \nHi this is Joe&#x27;, &#x27;metadata&#x27;: &#123;&#x27;Header 1&#x27;: &#x27;Foo&#x27;, &#x27;Header 2&#x27;: &#x27;Bar&#x27;&#125;&#125;</span><br><span class="line">&#123;&#x27;content&#x27;: &#x27;Hi this is Molly&#x27;, &#x27;metadata&#x27;: &#123;&#x27;Header 1&#x27;: &#x27;Foo&#x27;, &#x27;Header 2&#x27;: &#x27;Baz&#x27;&#125;&#125;</span><br></pre></td></tr></table></figure>

<p>让我们看一些下面的示例。</p>
<h3 id="2-基本用法"><a href="#2-基本用法" class="headerlink" title="2. 基本用法"></a>2. 基本用法</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%pip install -qU langchain-text-splitters</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_text_splitters <span class="keyword">import</span> MarkdownHeaderTextSplitter</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">markdown_document = <span class="string">&quot;# Foo\n\n    ## Bar\n\nHi this is Jim\n\nHi this is Joe\n\n ### Boo \n\n Hi this is Lance \n\n ## Baz\n\n Hi this is Molly&quot;</span></span><br><span class="line">headers_to_split_on = [</span><br><span class="line">    (<span class="string">&quot;#&quot;</span>, <span class="string">&quot;Header 1&quot;</span>),</span><br><span class="line">    (<span class="string">&quot;##&quot;</span>, <span class="string">&quot;Header 2&quot;</span>),</span><br><span class="line">    (<span class="string">&quot;###&quot;</span>, <span class="string">&quot;Header 3&quot;</span>),</span><br><span class="line">]</span><br><span class="line">markdown_splitter = MarkdownHeaderTextSplitter(headers_to_split_on)</span><br><span class="line">md_header_splits = markdown_splitter.split_text(markdown_document)</span><br><span class="line">md_header_splits</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[Document(page_content=&#x27;Hi this is Jim  \nHi this is Joe&#x27;, metadata=&#123;&#x27;Header 1&#x27;: &#x27;Foo&#x27;, &#x27;Header 2&#x27;: &#x27;Bar&#x27;&#125;),</span><br><span class="line"> Document(page_content=&#x27;Hi this is Lance&#x27;, metadata=&#123;&#x27;Header 1&#x27;: &#x27;Foo&#x27;, &#x27;Header 2&#x27;: &#x27;Bar&#x27;, &#x27;Header 3&#x27;: &#x27;Boo&#x27;&#125;),</span><br><span class="line"> Document(page_content=&#x27;Hi this is Molly&#x27;, metadata=&#123;&#x27;Header 1&#x27;: &#x27;Foo&#x27;, &#x27;Header 2&#x27;: &#x27;Baz&#x27;&#125;)]</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">type</span>(md_header_splits[<span class="number">0</span>])</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;class &#x27;langchain_core.documents.base.Document&#x27;&gt;</span><br></pre></td></tr></table></figure>

<p>默认情况下，<code>MarkdownHeaderTextSplitter</code> 会从输出块的内容中删除正在拆分的标题。可以通过设置 <code>strip_headers = False</code> 来禁用此功能。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">markdown_splitter = MarkdownHeaderTextSplitter(headers_to_split_on, strip_headers=<span class="literal">False</span>)</span><br><span class="line">md_header_splits = markdown_splitter.split_text(markdown_document)</span><br><span class="line">md_header_splits</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[Document(page_content=&#x27;# Foo  \n## Bar  \nHi this is Jim  \nHi this is Joe&#x27;, metadata=&#123;&#x27;Header 1&#x27;: &#x27;Foo&#x27;, &#x27;Header 2&#x27;: &#x27;Bar&#x27;&#125;),</span><br><span class="line"> Document(page_content=&#x27;### Boo  \nHi this is Lance&#x27;, metadata=&#123;&#x27;Header 1&#x27;: &#x27;Foo&#x27;, &#x27;Header 2&#x27;: &#x27;Bar&#x27;, &#x27;Header 3&#x27;: &#x27;Boo&#x27;&#125;),</span><br><span class="line"> Document(page_content=&#x27;## Baz  \nHi this is Molly&#x27;, metadata=&#123;&#x27;Header 1&#x27;: &#x27;Foo&#x27;, &#x27;Header 2&#x27;: &#x27;Baz&#x27;&#125;)]</span><br></pre></td></tr></table></figure>



<h2 id="四、如何按-token-来分割文本"><a href="#四、如何按-token-来分割文本" class="headerlink" title="四、如何按 token 来分割文本"></a>四、如何按 token 来分割文本</h2><p>语言模型有一个标记限制。您不应超过标记限制。因此，当您将文本分成块时，最好计算标记数。有许多标记器。在计算文本中的标记数时，应使用与语言模型中使用的相同的标记器。</p>
<h3 id="tiktoken"><a href="#tiktoken" class="headerlink" title="tiktoken"></a>tiktoken</h3><p><a target="_blank" rel="noopener" href="https://github.com/openai/tiktoken">tiktoken</a> 是由 OpenAI 创建的快速 <code>BPE</code> 标记器。</p>
<p>我们可以使用 <code>tiktoken</code> 来估算使用的标记数。对于 OpenAI 模型，这可能会更准确。</p>
<ol>
<li><p>文本如何分割：按传入的字符进行分割。</p>
</li>
<li><p>如何测量块大小：通过 <code>tiktoken</code> 标记器。</p>
</li>
</ol>
<p><a target="_blank" rel="noopener" href="https://api.python.langchain.com/en/latest/character/langchain_text_splitters.character.CharacterTextSplitter.html">CharacterTextSplitter</a>、<a target="_blank" rel="noopener" href="https://api.python.langchain.com/en/latest/character/langchain_text_splitters.character.RecursiveCharacterTextSplitter.html">RecursiveCharacterTextSplitter</a> 和 <a target="_blank" rel="noopener" href="https://api.python.langchain.com/en/latest/base/langchain_text_splitters.base.TokenTextSplitter.html">TokenTextSplitter</a> 可以直接与 <code>tiktoken</code> 一起使用。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%pip install --upgrade --quiet langchain-text-splitters tiktoken</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_text_splitters <span class="keyword">import</span> CharacterTextSplitter</span><br><span class="line"><span class="comment"># 这是一个长文档，我们可以将其分割。</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;../../resource/knowledge.txt&quot;</span>, encoding=<span class="string">&quot;utf-8&quot;</span>)<span class="keyword">as</span> f:</span><br><span class="line">    knowledge = f.read()</span><br></pre></td></tr></table></figure>

<p>要使用 <a target="_blank" rel="noopener" href="https://api.python.langchain.com/en/latest/character/langchain_text_splitters.character.CharacterTextSplitter.html">CharacterTextSplitter</a> 进行分割，然后使用 <code>tiktoken</code> 合并块，请使用其 <code>.from_tiktoken_encoder()</code> 方法。请注意，此方法生成的分割可能比 <code>tiktoken</code> 标记器测量的块大小要大。</p>
<p><code>.from_tiktoken_encoder()</code> 方法接受 <code>encoding_name</code>（例如 <code>cl100k_base</code>）或 <code>model_name</code>（例如 <code>gpt-4</code>）作为参数。所有额外的参数，如 <code>chunk_size</code>、<code>chunk_overlap</code> 和 <code>separators</code>，都用于实例化 <code>CharacterTextSplitter</code>：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">text_splitter = CharacterTextSplitter.from_tiktoken_encoder(</span><br><span class="line">    encoding_name=<span class="string">&quot;cl100k_base&quot;</span>, chunk_size=<span class="number">100</span>, chunk_overlap=<span class="number">0</span></span><br><span class="line">)</span><br><span class="line">texts = text_splitter.split_text(knowledge)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(texts[<span class="number">0</span>])</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">I am honored to be with you today at your commencement from one of the finest universities in the world. I never graduated from college. Truth be told, this is the closest I&#x27;ve ever gotten to a college graduation. Today I want to tell you three stories from my life. That&#x27;s it. No big deal. Just three stories.</span><br><span class="line">我今天很荣幸能和你们一起参加毕业典礼，斯坦福大学是世界上最好的大学之一。我从来没有从大学中毕业。说实话,今天也许是在我的生命中离大学毕业最近的一天了。今天我想向你们讲述我生活中的三个故事。不是什么大不了的事情,只是三个故事而已。</span><br><span class="line">The first story is about connecting the dots.</span><br><span class="line">第一个故事是关于如何把生命中的点点滴滴串连起来。</span><br><span class="line">I dropped out of Reed College after the first 6 months, but then stayed around as a drop-in for another 18 months or so before I really quit. So why did I drop out?</span><br><span class="line">我在Reed大学读了六个月之后就退学了，但是在十八个月以后——我真正的作出退学决定之前，我还经常去学校。我为什么要退学呢？</span><br></pre></td></tr></table></figure>

<p>要对块大小实施硬约束，我们可以使用 <code>RecursiveCharacterTextSplitter.from_tiktoken_encoder</code>，如果块大小较大，则会递归分割每个块：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_text_splitters <span class="keyword">import</span> RecursiveCharacterTextSplitter</span><br><span class="line">text_splitter = RecursiveCharacterTextSplitter.from_tiktoken_encoder(</span><br><span class="line">    model_name=<span class="string">&quot;gpt-4&quot;</span>,</span><br><span class="line">    chunk_size=<span class="number">100</span>,</span><br><span class="line">    chunk_overlap=<span class="number">0</span>,</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p>我们还可以加载一个 <code>TokenTextSplitter</code> 分割器，它直接与 <code>tiktoken</code> 一起使用，并确保每个分割块都比块大小小。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_text_splitters <span class="keyword">import</span> TokenTextSplitter</span><br><span class="line">text_splitter = TokenTextSplitter(chunk_size=<span class="number">10</span>, chunk_overlap=<span class="number">0</span>)</span><br><span class="line">texts = text_splitter.split_text(knowledge)</span><br><span class="line"><span class="built_in">print</span>(texts[<span class="number">0</span>])</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">I am honored to be with you</span><br></pre></td></tr></table></figure>

<p>一些书面语言（例如中文和日文）的字符编码为 2 个或更多个标记。直接使用 <code>TokenTextSplitter</code> 可能会导致字符的标记在两个块之间分割，从而导致不正确的 Unicode 字符。请使用 <code>RecursiveCharacterTextSplitter.from_tiktoken_encoder</code> 或 <code>CharacterTextSplitter.from_tiktoken_encoder</code> 来确保块包含有效的 Unicode 字符。</p>

    </div>

    
    
    
        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者： </strong>longchao
  </li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="http://mzfnai.com/2025/07/12/186LangChain%E7%AF%87-%E5%A4%9A%E7%B1%BB%E5%9E%8B%E6%96%87%E6%9C%AC%E5%88%86%E5%89%B2/" title="LangChain篇-多类型文本分割">http://mzfnai.com/2025/07/12/186LangChain篇-多类型文本分割/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fa fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>


      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/LangChain/" rel="tag"># LangChain</a>
              <a href="/tags/%E6%96%87%E6%A1%A3%E5%A4%84%E7%90%86/" rel="tag"># 文档处理</a>
              <a href="/tags/%E6%96%87%E6%9C%AC%E5%88%86%E5%89%B2/" rel="tag"># 文本分割</a>
              <a href="/tags/%E9%80%92%E5%BD%92%E5%88%86%E5%89%B2/" rel="tag"># 递归分割</a>
              <a href="/tags/%E6%96%87%E6%9C%AC%E5%88%87%E5%9D%97/" rel="tag"># 文本切块</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2025/07/11/185LangChain%E7%AF%87-%E5%A4%9A%E6%95%B0%E6%8D%AE%E6%BA%90%E9%9B%86%E6%88%90/" rel="prev" title="LangChain篇-多数据源集成">
      <i class="fa fa-chevron-left"></i> LangChain篇-多数据源集成
    </a></div>
      <div class="post-nav-item">
    <a href="/2025/07/13/187Dify%E7%AF%87-Dify%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/" rel="next" title="Dify篇-Dify快速入门">
      Dify篇-Dify快速入门 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%80%E3%80%81%E5%A6%82%E4%BD%95%E9%80%92%E5%BD%92%E5%88%86%E5%89%B2%E6%96%87%E6%9C%AC"><span class="nav-number">1.</span> <span class="nav-text">一、如何递归分割文本</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BB%8E%E6%B2%A1%E6%9C%89%E8%AF%8D%E8%BE%B9%E7%95%8C%E7%9A%84%E8%AF%AD%E8%A8%80%E4%B8%AD%E5%88%86%E5%89%B2%E6%96%87%E6%9C%AC"><span class="nav-number">1.1.</span> <span class="nav-text">从没有词边界的语言中分割文本</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BA%8C%E3%80%81%E6%8C%89%E7%85%A7%E8%AF%AD%E4%B9%89%E5%9D%97%E5%88%86%E5%89%B2%E6%96%87%E6%9C%AC"><span class="nav-number">2.</span> <span class="nav-text">二、按照语义块分割文本</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-%E5%AE%89%E8%A3%85%E4%BE%9D%E8%B5%96%E9%A1%B9"><span class="nav-number">2.1.</span> <span class="nav-text">1. 安装依赖项</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-%E8%BD%BD%E5%85%A5%E7%A4%BA%E4%BE%8B%E6%95%B0%E6%8D%AE"><span class="nav-number">2.2.</span> <span class="nav-text">2. 载入示例数据</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-%E5%88%9B%E5%BB%BA%E6%96%87%E6%9C%AC%E6%8B%86%E5%88%86%E5%99%A8"><span class="nav-number">2.3.</span> <span class="nav-text">3. 创建文本拆分器</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-%E6%8B%86%E5%88%86%E6%96%87%E6%9C%AC"><span class="nav-number">2.4.</span> <span class="nav-text">4. 拆分文本</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-%E6%96%AD%E7%82%B9"><span class="nav-number">2.5.</span> <span class="nav-text">5. 断点</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%99%BE%E5%88%86%E4%BD%8D%E6%95%B0"><span class="nav-number">2.5.1.</span> <span class="nav-text">百分位数</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%89%E3%80%81%E5%A6%82%E4%BD%95%E6%8C%89%E6%A0%87%E9%A2%98%E6%8B%86%E5%88%86-Markdown"><span class="nav-number">3.</span> <span class="nav-text">三、如何按标题拆分 Markdown</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-%E5%8A%A8%E6%9C%BA"><span class="nav-number">3.1.</span> <span class="nav-text">1. 动机</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-%E5%9F%BA%E6%9C%AC%E7%94%A8%E6%B3%95"><span class="nav-number">3.2.</span> <span class="nav-text">2. 基本用法</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%9B%9B%E3%80%81%E5%A6%82%E4%BD%95%E6%8C%89-token-%E6%9D%A5%E5%88%86%E5%89%B2%E6%96%87%E6%9C%AC"><span class="nav-number">4.</span> <span class="nav-text">四、如何按 token 来分割文本</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#tiktoken"><span class="nav-number">4.1.</span> <span class="nav-text">tiktoken</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="longchao"
      src="/images/avatar.gif">
  <p class="site-author-name" itemprop="name">longchao</p>
  <div class="site-description" itemprop="description">A blog about life, technology, and everything in between.</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">249</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
        <span class="site-state-item-count">79</span>
        <span class="site-state-item-name">分类</span>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">639</span>
        <span class="site-state-item-name">标签</span>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/longchao012" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;longchao012" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:longchao012@gmail.com" title="E-Mail → mailto:longchao012@gmail.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://plus.google.com/longchao012" title="Google → https:&#x2F;&#x2F;plus.google.com&#x2F;longchao012" rel="noopener" target="_blank"><i class="fa fa-fw fa-google"></i>Google</a>
      </span>
  </div>
  <div class="cc-license motion-element" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a>
  </div>



      </div>
        <div class="back-to-top motion-element">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 2022 – 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">longchao</span>
</div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

</body>
</html>
